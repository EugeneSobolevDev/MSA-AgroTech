### <a name="_b7urdng99y53"></a>**ADR 001: Платформа для мониторинга скота** 
### <a name="_hjk0fkfyohdk"></a>**Автор: Соболев Е.В.**
### <a name="_uanumrh8zrui"></a>**Дата: 30.11.2025**
### <a name="_3bfxc9a45514"></a>**Функциональные требования**
### Контекст
Компания «АгроТех Х» нуждается в MVP системы мониторинга свиноводческих ферм, которая должна работать в условиях нестабильной связи, 
обеспечивать автономность ферм и аналитику в реальном времени. 
Существующие рыночные решения не подходят из-за законодательных ограничений и высокой стоимости.
IT-ландшафт компании включает разнородные системы (ERP, BI, IoT-платформу), с которыми необходимо интегрироваться. 
На фермах присутствуют проблемы с WiFi-покрытием, требуется обработка видео с камер в ночное время и трекинг похожих друг на друга животных,
известна проблема, что нейронные сети путают тень животного с самим животным — для MVP не критично.
Готовую нейросетевую модель предоставят партнёры.

| **№** |  **Действующие лица или системы**   |                     **Use Case**                      |                                                                                                                                                                                                                                         **Описание**                                                                                                                                                                                                                                         |
|:-----:|:-----------------------------------:|:-----------------------------------------------------:|:--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------:|
|   1   | Оператор фермы, Система мониторинга | Получение экстренного оповещения о нештатной ситуации |   1. Система: Автоматически обнаруживает драку, задавливание поросят или другое ЧП через видеоаналитику<br>2. Система: Формирует оповещение с типом события и локацией<br>3. Оператор: Получает звуковое и визуальное уведомление на локальном устройстве в течение 5 секунд<br>4. Оператор: Подтверждает оповещение и направляется к месту события<br>5. Оператор: Фиксирует в системе принятые меры и результат<br>6. Система: Отмечает инцидент как обработанный и сохраняет в историю    |   
|   2   | Оператор фермы, Система мониторинга |           Управление кормушками и поилками	           |       1. Пользователь: Открывает интерфейс управления кормушками в веб-портале или мобильном приложении<br>2. Система: Отображает текущий статус всех кормушек (заполненность, режим работы)<br>3. Пользователь: Выбирает конкретную кормушку и устанавливает параметры кормления<br>4. Система: Отправляет команду на оборудование и подтверждает выполнение<br>5. Пользователь: Видит изменение статуса кормушки в реальном времени<br>6. Система: Логирует все операции управления        | 
|   3   |        Аналитик, BI система         |        Работа с BI-системой для анализа данных        | 1. Аналитик: Запускает BI-систему и подключается к источнику данных<br>2. Система: Предоставляет доступ к агрегированным данным и историческим метрикам<br>3. Аналитик: Строит пользовательские отчеты и дашборды для анализа эффективности<br>4. Аналитик: Проводит сравнительный анализ показателей разных ферм и периодов<br>5. Система: Выполняет сложные аналитические запросы и предоставляет визуализации<br>6. Аналитик: Формулирует выводы и рекомендации для оптимизации процессов |   
|   4   |   Директор хозяйства, Web-портал    |       Просмотр сводной аналитики по всем фермам       |    1. Директор: Заходит в веб-портал<br>2. Система: Отображает сводный дашборд с KPI всех ферм<br>3. Директор: Анализирует ключевые показатели эффективности (количество, состояние животных, расход кормов, продуктивность)<br>4. Директор: Детализирует данные до уровня отдельных ферм и временных периодов<br>5. Система: Предоставляет инструменты для сравнительного анализа и выявления тенденций<br>6. Директор: Формирует стратегические решения на основе полученной аналитики     |   
|   5   |   Директор хозяйства, Web-портал    |      Управление доступом и ролями пользователей       |                               1. Директор: Открывает раздел управления пользователями в веб-портале<br>2. Система: Отображает список всех пользователей и их ролей<br>3. Директор: Назначает права доступа для новых сотрудников<br>4. Директор: Корректирует роли существующих пользователей при изменении обязанностей<br>5. Система: Применяет изменения и уведомляет пользователей<br>6. Директор: Мониторит активность пользователей через систему аудита                               |   

### <a name="_u8xz25hbrgql"></a>**Нефункциональные требования**

| **№** | **Требование**                                                                                                      |
|:-----:|:--------------------------------------------------------------------------------------------------------------------|
|   1   | Отказоустойчивость 99.95%                                                                                           |
|   2   | Система должны быть расширяемой, то есть иметь возможность разработать новый функционал без изменений существующего |
|   3   | Оповещение о нештатной ситуации в течение 5 секунд                                                                  |
|   4   | Реакция системы видеоаналитики в реальном времени (миллисекунды)                                                    |
|   5   | Отказоустойчивость 99.95%                                                                                           |

### <a name="_qmphm5d6rvi3"></a>**Решение**
### Вариант 1. Автономные агенты (Edge-система)
@startuml C1_Вариант1
!include https://raw.githubusercontent.com/plantuml-stdlib/C4-PlantUML/master/C4_Context.puml

Person(директор, "Директор хозяйства", "Управление через веб-портал")
Person(аналитик, "Аналитик", "Работа с BI-системой")
Person(оператор, "Оператор мониторинга", "Контроль состояния животных, запасов корма")

System(агент_фермы, "Агент фермы (Edge)", "Обработка телеметрии, буферизация, экстренные уведомления, ML-сервер для обработки видео и рекомендаций")
System(центральный_сервер, "Центральный сервер", "Агрегация данных с ферм, долгосрочная аналитика, отчетность, глубокая видеоаналитика")
System_Ext(erp_system, "ERP система (1С:Агро)", "Финансы, склад, кадры")
System_Ext(bi_system, "BI система", "Отчеты и визуализация")

Rel(агент_фермы, центральный_сервер, "Передача данных\n(задержка до 10 минут)")
Rel(директор, центральный_сервер, "Использует")
Rel(центральный_сервер, bi_system, "Передает данные")
Rel(центральный_сервер, erp_system, "Передает данные")
Rel(erp_system, центральный_сервер, "Передает обработанные данные")
Rel(аналитик, bi_system, "Анализирует")
Rel_R(оператор, агент_фермы, "Получает экстренные уведомления, отчитывается об исправлении ситуации")
@enduml

### Вариант 2. Централизованная аналитика с легкими агентами
@startuml C1_Вариант2
!include https://raw.githubusercontent.com/plantuml-stdlib/C4-PlantUML/master/C4_Context.puml

Person(директор, "Директор хозяйства", "Управление через веб-портал")
Person(аналитик, "Аналитик", "Работа с BI-системой")
Person(оператор, "Оператор мониторинга", "Контроль состояния животных, запасов корма")

System(агент_сбора, "Агент сбора данных", "Сбор телеметрии, буферизация, базовые триггеры, передача видео")
System(центральный_сервер, "Центральный сервер", "Глубокая видеоаналитика, ML-обработка, управление, отчетность")
System_Ext(erp_system, "ERP система (1С:Агро)", "Финансы, склад, кадры")
System_Ext(bi_system, "BI система", "Отчеты и визуализация")

Rel(агент_сбора, центральный_сервер, "Передача видео и телеметрии\n(задержка до 10 минут)")
Rel(центральный_сервер, агент_сбора, "Команды управления, экстренные оповещения")
Rel(директор, центральный_сервер, "Использует")
Rel(аналитик, bi_system, "Анализирует")
Rel_R(оператор, агент_сбора, "получает оповещения от центра")
Rel(центральный_сервер, bi_system, "Передает данные")
Rel(центральный_сервер, erp_system, "Передает данные")
Rel(erp_system, центральный_сервер, "Передает обработанные данные")
@enduml

Также опишите, какой логикой вы руководствовались в ходе принятия решений и выбора технологий. Не забывайте, что необходимо учесть все функциональные и нефункциональные требования.
### <a name="_bjrr7veeh80c"></a>**Альтернативы**
Опишите здесь наиболее важные альтернативные решения.

**Недостатки, ограничения, риски**

Подробно опишите здесь недостатки, ограничения и риски выбранного решения.